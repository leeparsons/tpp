function generateShortDescription(){var e="",t=document.getElementById("full_description").value;if(this==document.getElementById("full_description")){var n=mb_strlen(t);document.getElementById("description_count").innerHTML=21e3-n+" characters remaining";n>21e3?document.getElementById("description_count").setAttribute("class","wp-error"):document.getElementById("description_count").setAttribute("class","wp-message")}var r=document.createElement("DIV");r.innerHTML=t;r.textContent?t=r.textContent:r.innerText&&(t=r.innerText);if(t&&document.getElementById("short_description").value==""){e=t.replace(/(\r\n|\n|\r)/gm," ").replace(/\s+/g," ").substr(0,150);document.getElementById("short_description").value=e}var i=150-document.getElementById("short_description").value.length;document.getElementById("short_character_count").innerHTML=i;document.getElementById("short_character_term").innerHTML=i==1?"character":"characters";i<0&&document.getElementById("short_character_count").parentNode.setAttribute("class","alert-danger")}function mb_strlen(e){var t=0;for(var n=0;n<e.length;n++)t+=e.charCodeAt(n)<0||e.charCodeAt(n)>255?2:1;return t}function catSwitcher(e,t,n){var r="",i=category_options,s=new sizer,o=0;for(var u=1;u<=t;u++)if(u>1)if(i!=undefined&&i.children[document.getElementById("category_"+u).value]!=undefined&&i.children[document.getElementById("category_"+u).value].children!=undefined){i=i.children[document.getElementById("category_"+u).value];s.setObj(i.children)}else s.setObj([]);else{i!=undefined&&i[document.getElementById("category_"+u).value]!=undefined&&i[document.getElementById("category_"+u).value].children!=undefined?s.setObj(i[document.getElementById("category_"+u).value].children):s.setObj([]);o=s.getSize();o>0?i=i[document.getElementById("category_"+u).value]:i=undefined}o=s.getSize();if(o>0){var e;document.getElementById("category_"+(t+1)).innerHTML="";r=document.createElement("option");r.setAttribute("value","");r.innerHTML="-- select --";document.getElementById("category_"+(t+1)).appendChild(r);for(var u=0;u<o;u++){e=s.getElementAt(u);r=document.createElement("option");r.setAttribute("value",e.category_id);r.innerHTML=e.category_name;document.getElementById("category_"+(t+1)).appendChild(r)}document.getElementById("category_"+(t+1)).parentNode.setAttribute("class","control-group")}else{var a=document.getElementsByClassName("category-list");for(var u=t;u<a.length;u++){a[u].innerHTML='<option value="">-- Select category -- </option>';a[u].parentNode.setAttribute("class","control-group hidden")}}}jQuery(function(e){e("fieldset").each(function(t){e(".aside-25").find("li").eq(t).data("ind",t);e(this).data("ind",t);t>0&&!e(this).hasClass("notoggle")?e(this).slideUp():e(this).addClass("open")});e("a.step").on("click",function(t){t.preventDefault();var n=e(this);e(".aside-25").find("li").eq(n.data("step")).click()});e(".aside-25").on("click","li",function(){generateShortDescription();var t=e(this);e("fieldset.open").removeClass("open").slideUp("normal",function(){e(".aside-25").find(".active").removeClass("active");t.addClass("active");e("fieldset").eq(t.data("ind")).addClass("open").slideDown("normal",function(){e("html, body").animate({scrollTop:e(".aside-25").offset().top},100)})})});e('[name="price_includes_tax"]').on("change",function(){if(document.getElementById("include_tax_na").checked===!0){document.getElementById("tax_rate").value="";document.getElementById("tax_group").style.display="none"}else document.getElementById("tax_group").style.display="block"});var t=!1,n=!1,r=0;e("#product_form").on("click",'input[type="submit"]',function(t){e("#product_form").data("e",e(this))});e("#product_form").on("submit",function(i){t!==!1&&t.abort();if(!0===dropper.uploading){var s=confirm("Some images have not finished uploading. If you choose to continue, you may lose these images. Continue?");if(!1===s)return!1}e(this).data("e").hasClass("publish")?document.getElementById("enabled_yes").checked=!0:e(this).data("e").hasClass("unpublish")&&(document.getElementById("enabled_no").checked=!0);e("#message").length==1&&e("#message").html("");var o=[],u=document.getElementById("include_tax_yes").checked,a=document.getElementById("include_tax_no").checked;if(u===!0||a===!0){var f=document.getElementById("tax_rate").value;(f==""||!isFinite(f)||isNaN(parseFloat(f))||parseFloat(f)<0)&&o.push("Please enter a tax rate so we can determine the tax to display on invoices")}if(document.getElementById("product_type").value==4){document.getElementById("mentor_name").value.replace(/\s+/g,"")==""&&o.push("Please enter the mentor's name");document.getElementById("mentor_company").value.replace(/\s+/g,"")==""&&o.push("Please enter the mentor's company/ business name")}e("#product_title").val().replace(/\s+/g,"")==""&&o.push("Please enter a title");if(!1===e("#unlimited").is(":checked")){var l=e("#product_quantity").val();(l.replace(/\s+/g,"")==""||!isFinite(l)||isNaN(parseInt(l))||l.indexOf(".")>-1||l.indexOf(",")>-1)&&o.push('Please enter the quantity available as a number (without "." or ",")')}var c=e("#product_price").val();(!isFinite(c)||isNaN(parseFloat(c)))&&o.push('Please enter a price (no ",")');e(".preview").find("img").length===0&&o.push("Please upload at least one image.");if(e("#discount_type").is(":checked")){var h=e("#discount_value").val();(h.replace(/\s+/g,"")==""||!isFinite(h)||isNaN(parseInt(h))||h.indexOf(".")>-1||h.indexOf(",")>-1)&&o.push("Please enter a discount value")}if(o.length>0){i.preventDefault();if(e("#message").length==0){var p=e('<div id="message"></div>');e(".page-article-part").find("form").eq(0).prepend(p)}else var p=e("#message");for(var d in o)p.append('<p class="wp-error">'+o[d]+"</p>");e("html, body").animate({scrollTop:p.offset().top},750);overlay.setHeader("Oops, sorry there were errors");p=[];for(var d in o)p.push(o[d]);overlay.setBody("Please see the error messages and fill in the required fields:<br><br>"+p.join("<br>"));overlay.populateInner();return!1}if(e(this).data("e").hasClass("preview")){overlay.setHeader("Crunching images and saving...");overlay.setBody("Please wait while we save your product and upload your images...");overlay.populateInner();e(this).find("#ajax").length==0?e(this).append('<input type="hidden" id="ajax" name="preview" value="1">'):e(this).find("#ajax").val("1");var v=e(this).serialize();t=e.ajax({url:e(this).prop("action"),type:"post",data:v,success:function(t){console.log(t);overlay.setHeader("Saved!");overlay.setBody("Sending you to the preview... (please note if you do not see the preview open then you may have popups blocked (this is default in most browsers)<br><br>Please enable popups for this website to view your preview.");overlay.populateInner();console.log(t);if(t.error===!1&&t.data&&t.data.location){n=window.open(t.data.location,"_blank");setTimeout(function(){r=setInterval(function(){if(n==null||n.closed){overlay.close();clearInterval(r);e.ajax("/shop/dashboard/preview_close/")}},100)},15e3)}return},error:function(e){if(e.status>0){overlay.setHeader("Oops!");overlay.setBody("there was a problem saving your product. Please make sure you have filled out all the required fields");overlay.populateInner()}else overlay.close()}});i.preventDefault();return!1}e(this).find("#ajax").val("0").remove()})});var product_options_count=0,sizer=function(){this.obj=[];this.setObj=function(e){this.obj=e};this.getSize=function(){var e=0;for(var t in this.obj)this.obj.hasOwnProperty(t)&&e++;return e};this.getElementAt=function(e){if(e!=undefined){var t=0;for(var n in this.obj)if(this.obj.hasOwnProperty(n)){if(t==e)return this.obj[n];t++}}return!1}};document.getElementById("unlimited").onclick=function(){var e=this.checked;e===!0?document.getElementById("product_quantity").style.visibility="hidden":document.getElementById("product_quantity").style.visibility="visible"};document.getElementById("add_product_variation")&&(document.getElementById("add_product_variation").onclick=function(){var e=document.getElementById("variation_cost").value,t=document.getElementById("variation_name").value,n=document.getElementById("variation_availability").value;switch(currency){default:e=e.replace("\u00a3","").replace(currency,"");break;case"&dollar;":e=e.replace("$","").replace(currency,"")}document.getElementById("option_cost_error").setAttribute("class","hidden wp-error");document.getElementById("option_availability_error").setAttribute("class","hidden wp-error");document.getElementById("option_name_error").setAttribute("class","hidden wp-error");error=!1;if(e.replace(/\s/g,"")==""||isNaN(parseFloat(e))){document.getElementById("option_cost_error").innerHTML="Please enter a price";document.getElementById("option_cost_error").setAttribute("class","wp-error");error=!0}if(t.replace(/\s/g,"")==""){document.getElementById("option_name_error").innerHTML="Please enter a name";document.getElementById("option_name_error").setAttribute("class","wp-error");error=!0}if(isNaN(parseInt(n))){document.getElementById("option_availability_error").innerHTML="Please enter the quantity available";document.getElementById("option_availability_error").setAttribute("class","wp-error");error=!0}if(error===!1){var r=document.createElement("li"),i=document.createElement("span");i.setAttribute("class","close");i.innerHTML="x";r.innerHTML='<span class="option-name">'+t+'</span><span class="option-price"> '+currency+parseFloat(e)+'</span> <span class="option-availability">'+parseInt(n)+" available</span>"+'<input type="hidden" name="product_option_new['+product_options_count+'][name]" value="'+encodeURI(t)+'">'+'<input type="hidden" name="product_option_new['+product_options_count+'][price]" value="'+parseFloat(e)+'">'+'<input type="hidden" name="product_option_new['+product_options_count+'][availability]" value="'+parseInt(n)+'">';product_options_count++;r.appendChild(i);i.onclick=function(){document.getElementById("product_options").removeChild(this.parentNode)};document.getElementById("product_options").appendChild(r);this.disabled=!0;this.value="Option Added!";var s=this;setTimeout(function(){document.getElementById("variation_cost").value="";document.getElementById("variation_name").value="";document.getElementById("variation_availability").value="";s.disabled=!1;s.value="Add Option"},500)}return!1});if(document.getElementsByClassName("close").length>0)for(var x in document.getElementsByClassName("close"))document.getElementsByClassName("close")[x].onclick=function(){document.getElementById("product_options").removeChild(this.parentNode)};document.getElementById("product_type").onchange=function(){var e=document.getElementsByClassName("product-type-group");this.value==2?document.getElementById("product_type_label").style.display="block":document.getElementById("product_type_label").style.display="none";for(var t=0;t<e.length;t++)t+1!=this.value?e[t].setAttribute("class","product-type-group form-group hidden"):e[t].setAttribute("class","product-type-group form-group")};document.getElementById("full_description").onkeyup=generateShortDescription;document.getElementById("short_description").onkeyup=generateShortDescription;if(document.getElementById("category_1")){document.getElementById("category_1").onchange=function(){if(this.value==3){document.getElementById("product_type").value=2;document.getElementById("product_type").style.display="none";document.getElementById("product_type_label").style.display="none";document.getElementById("download_group").setAttribute("class","product-type-group form-group hidden")}else{document.getElementById("product_type").style.display="block";document.getElementById("product_type_label").style.display="block";document.getElementById("product_type").value=2;document.getElementById("download_group").setAttribute("class","product-type-group form-group hidden")}catSwitcher(this,1)};document.getElementById("category_2").onchange=function(){catSwitcher(this,2,[document.getElementById("category_1").value])}}document.getElementById("discount_value").onkeyup=function(){this.value=this.value.replace(/[^0-9.]/g,"")};
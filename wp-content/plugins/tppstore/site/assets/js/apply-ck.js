var fbApply={fbStatus:function(){if(fbLogin.me>0){overlay.setHeader("Detecting Previous Applications");overlay.setBody("Please wait while we check your application status...");jQuery(".page-article").find("header").eq(0).slideUp(500,function(){jQuery(this).html("<h2>Welcome, "+fbLogin.me_data.first_name+"!</h2>").slideDown()});jQuery.ajax({url:"/shop/application-status/",type:"post",data:{fid:fbLogin.me},dataType:"json",success:function(e){console.log(e);if(e.status&&e.status=="success")if(e.data)if(e.data.state==1){overlay.setHeader("Oops!");overlay.setBody("It looks as though you have already have a store with us. Please contact us if you think this is not the case.");fbApply.hideAll("It looks as though you have already have a store with us. Please contact us if you think this is not the case.")}else if(e.data.state==-2){overlay.close();fbApply.replace(e.data)}else if(e.data.state==-1){fbApply.hideAll("It looks as though a previous application was declined. Please contact us if you think this is not the case.<br><br>You can also re apply from your account.");overlay.setHeader("Oops!");overlay.setBody("It looks as though a previous application was declined. Please contact us if you think this is not the case.<br><br>You can also re apply from your account.")}else{fbApply.hideAll("We have found a store application for you on file, but it is currently pending approval. If you do not hear from us within the next 24 hours, please feel free to get in touch about your application.");overlay.setHeader("Oops!");overlay.setBody("We have found a store application for you on file, but it is currently pending approval. If you do not hear from us within the next 24 hours, please feel free to get in touch about your application.")}else{fbApply.hideAll("Something unusual happened, please contact us! - looks like the response did not contain any data");overlay.setHeader("Oops! That wasn't supposed to happen");overlay.setBody("Something unusual happened, please contact us!")}else{fbApply.hideAll("Something unusual happened, please contact us!"+e.status+"no status?");overlay.setHeader("Oops! That wasn't supposed to happen");overlay.setBody("Something unusual happened, please contact us!")}},error:function(e){if(e.readyState!=0){fbApply.hideAll("Opps! There was an error:<br><br>"+e.responseText);overlay.setHeader("Opps! There was an error");overlay.setBody(e.responseText)}else overlay.close()}})}else{overlay.setHeader("Oops, something went wrong!");overlay.setBody("We could not detect your Facebook connection. Please try again!!")}},hideAll:function(e){e!=undefined?jQuery("fieldset").each(function(t){t>0?jQuery(this).remove():jQuery(this).html("<p>"+e+"</p>")}):jQuery("fieldset").remove()},replace:function(e){jQuery("#facebook_register_form").parent().remove();jQuery("#user_email").prev("label").hide().parent().parent().removeClass("half-right");jQuery("#user_email").val(e.user.email).hide().after('<span>You have chosen to sign in with Facebook. If in the future you want to log in via email, we have sent your password to your email address registered with Facebook. You can manage your preferences via "Your Account" at the top of the website.</span>');jQuery("fieldset").eq(2).find(".form-group").eq(2).remove();jQuery("fieldset").eq(2).find(".form-group").eq(1).remove();jQuery("#user_email");jQuery("#u_title").val(e.user.title);jQuery("#f_name").val(e.user.first_name);jQuery("#l_name").val(e.user.last_name)},init:function(){if(fbLogin.me==0&&document.getElementById("fb_connect")){jQuery("#fb_connect").die("click");jQuery("#fb_connect").click(function(e){e.preventDefault();overlay.setHeader("Connecting to Facebook");overlay.setBody("Please wait while we connect you ...");overlay.populateInner();fbLogin.discover=!1;fbLogin.getFBLoginStatus(!0,"fbApply.fbStatus()");return!1})}}};jQuery(function(e){e(document).on("facebook:ready",function(){fbApply.init()});e("div.slider").each(function(t){t>0&&e(this).slideUp();if(t<e("div.slider").length-1){var n=document.createElement("a");jQuery(n).text("Next");n.setAttribute("class","btn btn-primary align-left");n.style.marginBottom="20px";e(n).on("click",function(){e(this).parent().parent().next("fieldset").find("legend").data("callback","focusLegend()").click()});e(this).append(n)}});e("legend").on("click",function(t){var n=e(this);e("div.slider").slideUp("fast");e("legend.active").removeClass("active");n.addClass("active").next("div.slider").slideDown("fast",function(){e("html, body").animate({scrollTop:n.offset().top},100)})});e("form#application_form").submit(function(t){var n=[];!1===e("#terms").is(":checked")&&n.push("Please accept our terms and conditions");if(e("#user_email").length==1){var r=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;r.test(e("#user_email").val())||n.push("Enter a valid email")}e("#u_password").length==1&&e("#u_password_confirm").length==1&&(e("#u_password").val()==""||e("#u_password_confirm").val()=="")&&n.push("Please enter your password");e("#f_name").length==1&&e("#f_name").val()==""&&n.push("Please enter your name");if(n.length>0){if(e("#message").length==0){var i=document.createElement("div");i.setAttribute("class","error");i.setAttribute("id","message");i=e(i);e("#application_form").prepend(i)}else{var i=e("#message");i.find("p").remove()}for(var s=0;s<n.length;s++)i.append('<p class="wp-error">'+n[s]+"</p>");e("html, body").animate({scrollTop:i.offset().top},500);t.preventDefault()}});e("#l_name, #store_website").on({keydown:function(t){t.keyCode==9&&!1===t.shiftKey&&e(this).parent().parent().parent().next("fieldset").length==1&&e(this).parent().parent().parent().next("fieldset").find("legend").click()}});e("#u_password_confirm").on({keydown:function(t){t.keyCode==9&&!1===t.shiftKey&&e(this).parent().parent().parent().parent().parent().next("fieldset").length==1&&e(this).parent().parent().parent().parent().parent().next("fieldset").find("legend").click()}});e("#user_email").on({keydown:function(t){t.keyCode==9&&!0===t.shiftKey&&e(this).parent().parent().parent().parent().parent().prev("fieldset").length==1&&e(this).parent().parent().parent().parent().parent().prev("fieldset").find("legend").click()}});e("#how, #u_title").on({keydown:function(t){t.keyCode==9&&!0===t.shiftKey&&e(this).parent().parent().parent().prev("fieldset").length==1&&e(this).parent().parent().parent().prev("fieldset").find("legend").click()}})});